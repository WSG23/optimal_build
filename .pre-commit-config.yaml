repos:
- repo: local
  hooks:
    - id: audit-migrations
      name: audit-migrations
      entry: python3 scripts/audit_migrations.py
      language: system
      pass_filenames: false
    - id: verify
      name: make-verify
      entry: make verify
      language: system
      pass_filenames: false
      stages: [commit]

- repo: https://github.com/pre-commit/pre-commit-hooks
  rev: v4.6.0
  hooks:
    - id: end-of-file-fixer
    - id: trailing-whitespace
    - id: check-yaml
    - id: check-merge-conflict

- repo: https://github.com/psf/black
  rev: 24.8.0
  hooks:
    - id: black
      args: ["--line-length=88"]
      files: ^(backend|app|core|db|jurisdictions|scripts|tests|uvicorn_app|prefect|jobs|samples)/

- repo: https://github.com/astral-sh/ruff-pre-commit
  rev: v0.6.9
  hooks:
    - id: ruff
      args: ["--fix"]
      files: ^(backend|app|core|db|jurisdictions|scripts|tests|uvicorn_app|prefect|jobs|samples)/

- repo: https://github.com/PyCQA/flake8
  rev: 7.1.1
  hooks:
    - id: flake8
      additional_dependencies: [flake8-bugbear==24.8.19]
      files: ^(backend/tests|tests)/

- repo: https://github.com/pre-commit/mirrors-mypy
  rev: v1.7.1
  hooks:
    - id: mypy
      name: mypy-backend
      files: ^backend/
      args: [--config-file=mypy.ini]
      pass_filenames: false
      additional_dependencies:
        - fastapi==0.104.1
        - uvicorn[standard]==0.24.0
        - pydantic[email]==2.5.0
        - pydantic==2.5.0
        - sqlalchemy[asyncio]==2.0.23
        - asyncpg==0.29.0
        - alembic==1.13.0
        - python-multipart==0.0.6
        - python-jose[cryptography]==3.3.0
        - passlib[bcrypt]==1.7.4
        - httpx==0.25.2
        - python-dateutil==2.8.2
        - prefect==2.14.10
        - structlog==23.2.0
        - prometheus-client==0.19.0

- repo: https://github.com/pre-commit/mirrors-prettier
  rev: v3.1.0
  hooks:
    - id: prettier
      files: ^(frontend|ui-admin)/
      exclude: ^(frontend|ui-admin)/node_modules/

- repo: https://github.com/pre-commit/mirrors-eslint
  rev: v9.9.0
  hooks:
    - id: eslint
      files: ^(frontend|ui-admin)/
      additional_dependencies:
        - eslint@9.11.1
        - '@typescript-eslint/eslint-plugin@8.44.1'
        - '@typescript-eslint/parser@8.44.1'
        - eslint-plugin-react-hooks@4.6.0
        - eslint-plugin-react-refresh@0.4.4
        - '@eslint/js@9.11.1'
        - globals@13.24.0

- repo: https://github.com/gitleaks/gitleaks
  rev: v8.18.4
  hooks:
    - id: gitleaks
      args: ["protect", "--verbose", "--redact", "--staged"]
